diff -up pdns-5.0.2/pdns/arguments.cc.2~ pdns-5.0.2/pdns/arguments.cc
--- pdns-5.0.2/pdns/arguments.cc.2~	2025-12-11 09:59:35.000000000 +0100
+++ pdns-5.0.2/pdns/arguments.cc	2026-02-18 03:31:06.518176494 +0100
@@ -341,6 +341,8 @@ double ArgvMap::asDouble(const string& a
 ArgvMap::ArgvMap()
 {
   set("ignore-unknown-settings", "Configuration settings to ignore if they are unknown") = "";
+  set("setuid", "If set, change user id") = "powerdns";
+  set("setgid", "If set, change group id") = "powerdns";
 }
 
 bool ArgvMap::parmIsset(const string& var)
@@ -606,3 +608,39 @@ void ArgvMap::gatherIncludes(const std::
   std::sort(vec.begin(), vec.end(), CIStringComparePOSIX());
   extraConfigs.insert(extraConfigs.end(), vec.begin(), vec.end());
 }
+
+int ArgvMap::targetUid() {
+  std::string uid_str = (*this)["setuid"];
+  if (uid_str.empty()) uid_str = "powerdns";
+
+  struct passwd *pw = getpwnam(uid_str.c_str());
+  if(pw)
+    return pw->pw_uid;
+  return 0;
+}
+
+int ArgvMap::targetGid() {
+  std::string uid_str = (*this)["setuid"];
+  if (uid_str.empty()) uid_str = "powerdns";
+
+  struct passwd *pw = getpwnam(uid_str.c_str());
+  if(pw)
+    return pw->pw_gid;
+  return 0;
+}
+
+bool ArgvMap::dropPrivileges() {
+  if (getuid() != 0)
+    return true;
+
+  std::string uid_str = (*this)["setuid"];
+  if (uid_str.empty()) uid_str = "powerdns";
+
+  struct passwd *pw = getpwnam(uid_str.c_str());
+  if (pw) {
+    initgroups(pw->pw_name, pw->pw_gid);
+    setresgid(pw->pw_gid, pw->pw_gid, pw->pw_gid);
+    return setresuid(pw->pw_uid, pw->pw_uid, pw->pw_uid) == 0;
+  }
+  return false;
+}
diff -up pdns-5.0.2/pdns/arguments.hh.2~ pdns-5.0.2/pdns/arguments.hh
--- pdns-5.0.2/pdns/arguments.hh.2~	2025-12-11 09:59:35.000000000 +0100
+++ pdns-5.0.2/pdns/arguments.hh	2026-02-18 03:30:39.208801041 +0100
@@ -107,6 +107,9 @@ public:
   bool isEmpty(const string& arg); //!< checks if variable has value
   void setDefault(const string& var, const string& value);
   void setDefaults();
+  int targetUid();
+  int targetGid();
+  bool dropPrivileges();
 
   vector<string> list();
   [[nodiscard]] string getHelp(const string& item) const
diff -up pdns-5.0.2/pdns/pdnsutil.cc.2~ pdns-5.0.2/pdns/pdnsutil.cc
--- pdns-5.0.2/pdns/pdnsutil.cc.2~	2025-12-11 09:59:35.000000000 +0100
+++ pdns-5.0.2/pdns/pdnsutil.cc	2026-02-18 03:31:25.434464605 +0100
@@ -1926,6 +1926,8 @@ static int editZone(const ZoneName &zone
   if (result != 0) {
     throw std::runtime_error("Editing file with: '" + editor + "' returned non-zero status " + std::to_string(result));
   }
+  chown(tmpnam, ::arg().targetUid(), ::arg().targetGid());
+  ::arg().dropPrivileges();
   ZoneParserTNG zpt(static_cast<const char *>(tmpnam), g_rootzonename);
   zpt.setMaxGenerateSteps(::arg().asNum("max-generate-steps"));
   zpt.setMaxIncludes(::arg().asNum("max-include-depth"));
@@ -5728,6 +5730,19 @@ try
 
   loadMainConfig(g_vm["config-dir"].as<string>());
 
+  try {
+    ::arg().file(::arg()["config-file"].c_str());
+  } catch(...) {}
+  bool is_edit = false;
+  if (!cmds.empty()) {
+    if (cmds[0] == "edit-zone")
+      is_edit = true;
+    else if (cmds[0] == "zone" && cmds.size() > 1 && cmds[1] == "edit")
+      is_edit = true;
+  }
+  if (!is_edit)
+    ::arg().dropPrivileges();
+
   std::string writtencommand;
   if (commandEntry command; parseCommand(cmds, writtencommand, command)) {
     if (command.requiresInitialization) {
diff -up pdns-5.0.2/pdns/zone2json.cc.2~ pdns-5.0.2/pdns/zone2json.cc
--- pdns-5.0.2/pdns/zone2json.cc.2~	2026-02-18 03:32:46.239475264 +0100
+++ pdns-5.0.2/pdns/zone2json.cc	2026-02-18 03:33:00.137746277 +0100
@@ -115,6 +115,7 @@ try
     string zonefile="";
 
     ::arg().parse(argc, argv);
+    ::arg().dropPrivileges();
 
     if(::arg().mustDo("version")){
       cerr<<"zone2json "<<VERSION<<endl;
diff -up pdns-5.0.2/pdns/zone2ldap.cc.2~ pdns-5.0.2/pdns/zone2ldap.cc
--- pdns-5.0.2/pdns/zone2ldap.cc.2~	2026-02-18 03:33:28.225078930 +0100
+++ pdns-5.0.2/pdns/zone2ldap.cc	2026-02-18 03:33:35.757322464 +0100
@@ -251,6 +251,7 @@ int main( int argc, char* argv[] )
                 args.set( "max-include-depth", "Maximum nested $INCLUDE depth when loading a zone from a file")="20";
 
                 args.parse( argc, argv );
+		args.dropPrivileges();
 
                 if(args.mustDo("version")) {
                   cerr<<"zone2ldap "<<VERSION<<endl;
diff -up pdns-5.0.2/pdns/zone2sql.cc.2~ pdns-5.0.2/pdns/zone2sql.cc
--- pdns-5.0.2/pdns/zone2sql.cc.2~	2026-02-18 03:33:08.977813988 +0100
+++ pdns-5.0.2/pdns/zone2sql.cc	2026-02-18 03:33:21.386201580 +0100
@@ -229,6 +229,7 @@ try
     string zonefile="";
 
     ::arg().parse(argc, argv);
+    ::arg().dropPrivileges();
 
     if(::arg().mustDo("version")) {
       cerr<<"zone2sql "<<VERSION<<endl;
